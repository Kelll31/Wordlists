## lottapixel

Изначально сообщено на https://hackerone.com/reports/390, устранено в Paperclip.

Специально созданный JPEG (оригинальный файл назывался lottapixel.jpg) вызывает исчерпание доступной памяти при попытке определить размеры изображения. Из оригинального отчета:

Эксплойт очень прост. У меня есть изображение размером 5 КБ, 260x260 пикселей. В самом изображении я заменяю значения 260x260 на 0xfafa x 0xfafa (то есть 64250x64250 пикселей). Насколько я помню, ваш сервис пытается конвертировать изображение после загрузки. Загружая "всё изображение" в память, он пытается выделить место для 4128062500 пикселей, переполняя память и вызывая DoS.

## uber.gif

Текущие ограничения:

Размер изображения: 1 МБ  
Размеры изображения: 2048x2048 пикселей  
Типы файлов: jpg/png/gif  

Еще одна уязвимость с изображением:

GIF, состоящий из 40 тысяч изображений размером 1x1 пиксель, заставляет Paperclip зависать до истечения времени ожидания.

В приложении я отправил файл из 40 тысяч изображений и скриншот таймаута.

## EICAR File

Тестовый файл антивируса EICAR или тестовый файл EICAR — это компьютерный файл, разработанный Европейским институтом исследований компьютерных вирусов (EICAR) и Организацией исследований компьютерных вирусов (CARO), чтобы проверять реакцию антивирусных программ. Вместо использования реального вредоносного ПО, которое может нанести реальный ущерб, этот тестовый файл позволяет проверять антивирусное программное обеспечение без необходимости использовать настоящий вирус.

Программисты антивирусов настроили строку EICAR как подтвержденный вирус, аналогично другим идентифицированным сигнатурам. Совместимый антивирусный сканер при обнаружении файла будет реагировать точно так же, как если бы он нашел вредоносный вирус. Не все антивирусные сканеры совместимы и могут не обнаружить файл даже при правильной настройке.

Использование строки теста EICAR может быть более универсальным, чем простое обнаружение: файл со строкой теста EICAR можно сжать или архивировать, а затем запустить антивирусное ПО для проверки его способности обнаруживать строку теста в сжатом файле.

## xssproject File

Как вы уже знаете, возможно сделать сайт уязвимым к XSS-атакам путем загрузки/включения SWF-файла на этот сайт. Я представляю этот SWF-файл для использования в ваших PoC.

Этот метод основан на [1] и [2], протестирован в Google Chrome, Mozilla Firefox и IE9/8; также не должно возникнуть проблем с другими браузерами.

Примеры:

Для браузеров кроме IE: http://0me.me/demo/xss/xssproject.swf?js=alert(document.domain);

Для IE8: http://0me.me/demo/xss/xssproject.swf?js=try{alert(document.domain)}catch(e){ window.open(‘?js=history.go(-1)’,’_self’);}

Для IE9: http://0me.me/demo/xss/xssproject.swf?js=w=window.open(‘invalidfileinvalidfileinvalidfile’,’target’);setTimeout(‘alert(w.document.location);w.close();’,1);

## POC_img_phpinfo File

Описано здесь: https://www.secgeek.net/bookfresh-vulnerability/

## PHPInfo.zip

Этот zip-файл содержит файлы с именами для обхода черных списков и доступа к `phpinfo.php`:

- ` make-aio.sh`  
- ` phpinfo-aio.tar`  
- ` phpinfo-aio.zip`  
- `'phpinfo.""gif'`  
- `'phpinfo."gif'`  
- `"phpinfo.''gif"`  
- `"phpinfo.'gif"`  
- ` phpinfo.jpg.php`  
- ` phpinfo-metadata.gif`  
- ` phpinfo-metadata.jpg`  
- ` phpinfo.php`  
- ` phpinfo.php-1.gif`  
- ` phpinfo.php-2.gif`  
- ` phpinfo.php3`  
- ` phpinfo.php4`  
- ` phpinfo.php5`  
- ` phpinfo.php7`  
- `'phpinfo.php.""gif'`   
- `'phpinfo.php."gif'`
 - `"phpinfo.php.''gif"`   
 - `"phpinfo.php.'gif"`   
 - ` phpinfo.phpt`
 - `'phpinfo.php;.txt'`
 - ` phpinfo.pht`
 - ` phpinfo.phtml`
 - ` phpinfo-shortsyntax.php`
 - ` phpinfo.txt`

Распаковать этот файл невозможно в Windows из-за их произвольных ограничений на имена файлов. Однако его можно распаковать в WSL.